#include<stdio.h>
#include<stdlib.h>
#include<graphics.h>
#include<dos.h>
int c1,c2=0,c3=0;
    char zhe16K[]={
  0x02,0x00,0x02,0x00,0x02,0x10,0x03,0xA0,
  0x0E,0x40,0x02,0xFE,0xFF,0x00,0x02,0x00,
  0x07,0xC0,0x0C,0x40,0x17,0x40,0x24,0x40,
  0xC7,0xC0,0x04,0x40,0x00,0x40,0x00,0x00,
};
    char zuo16K[]={
  0x00,0x40,0x08,0x40,0x08,0x80,0x08,0x9C,
  0x11,0xE0,0x31,0x40,0x52,0x40,0x94,0x78,
  0x10,0x40,0x10,0x40,0x10,0x78,0x10,0x40,
  0x10,0x40,0x00,0x40,0x00,0x40,0x00,0x00,
};
    char zhan16K[]={
  0x01,0x00,0x03,0xE0,0x04,0x40,0x00,0xF0,
  0x1F,0x40,0x12,0xA0,0x14,0xFC,0x1F,0x00,
  0x11,0x80,0x10,0x60,0x23,0x80,0x20,0x60,
  0x47,0xA0,0x84,0x20,0x03,0xC0,0x00,0x00,
};
    char zhao16K[]={
  0x00,0x00,0x00,0x00,0x38,0x38,0x49,0xC8,
  0x48,0x48,0x48,0x88,0x78,0xB0,0x49,0x00,
  0x4A,0x38,0x49,0xC8,0x79,0x08,0x49,0x18,
  0x01,0xE0,0x00,0x00,0x00,0x00,0x00,0x00,
};
    char ji16K[]={
  0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,
  0x01,0xFC,0x7F,0x00,0x01,0x00,0x01,0xF0,
  0x0F,0x00,0x00,0x00,0x03,0xF0,0x0C,0x10,
  0x08,0x20,0x07,0xE0,0x04,0x00,0x00,0x00,
};
    char han32L[]={
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,
  0x03,0x03,0xFF,0xC0,0x03,0xC3,0x01,0xC0,
  0x01,0xE0,0x00,0x80,0x00,0x02,0x01,0x80,
  0x00,0x01,0x01,0x80,0x38,0x00,0x81,0x00,
  0x3E,0x00,0x43,0x00,0x1F,0x80,0x26,0x00,
  0x00,0x00,0x1E,0x00,0x00,0x00,0x0C,0x00,
  0x00,0x00,0x1E,0x00,0x00,0x20,0x3F,0x80,
  0x01,0xC0,0xE1,0xE0,0x07,0x87,0x80,0xF8,
  0x07,0x3E,0x00,0x7C,0x04,0x18,0x00,0x3C,
  0x00,0x00,0x00,0x18,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};
    char nuo32L[]={
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x06,0x00,0x43,0x00,
  0x07,0x07,0xFF,0xF0,0x03,0xCF,0xFF,0xF0,
  0x00,0x00,0x43,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x18,0x00,0x3F,0x9F,0xFF,0xFE,
  0x3F,0xFF,0xFF,0xFC,0x01,0x20,0x60,0x18,
  0x01,0x00,0xC0,0x00,0x00,0x03,0xFF,0xC0,
  0x00,0x0F,0xFF,0xE0,0x00,0x18,0x00,0x60,
  0x03,0x00,0x00,0x40,0x03,0xC0,0x00,0x40,
  0x07,0x80,0x7F,0xC0,0x07,0x00,0x7F,0xC0,
  0x02,0x00,0x40,0xC0,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};

    char ta32L[]={
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x01,0x02,0x00,0x01,0x01,0x02,0x00,
  0x01,0x0F,0xFF,0xC0,0x01,0x1F,0xFF,0xE0,
  0x01,0x01,0x02,0x00,0x01,0x00,0x10,0x00,
  0x1F,0xE0,0x30,0x00,0x1F,0xC0,0xCE,0x00,
  0x01,0x01,0x83,0x80,0x01,0x0E,0x00,0xF8,
  0x01,0x18,0xFC,0x7C,0x01,0x00,0xC0,0x1C,
  0x01,0xE0,0x00,0x00,0x3F,0xC7,0xFF,0x80,
  0x3F,0x07,0xFF,0x80,0x38,0x00,0x01,0x80,
  0x00,0x02,0x01,0x80,0x00,0x03,0xFF,0x00,
  0x00,0x03,0xFF,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};
    char yan32L[]={
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x30,0x00,0x00,0x00,0x30,0x00,
  0x0E,0x00,0x30,0x00,0x0F,0x1F,0xFF,0xF0,
  0x03,0x9C,0x00,0x70,0x00,0x10,0x00,0x10,
  0x00,0x03,0xFF,0x10,0x30,0x00,0x10,0x00,
  0x3C,0x07,0xFF,0x80,0x3F,0x06,0x10,0xC0,
  0x00,0x04,0x10,0x80,0x00,0x07,0xFF,0x80,
  0x00,0x00,0x10,0x80,0x00,0xC3,0xFF,0x80,
  0x03,0x83,0xFF,0x80,0x0F,0x00,0x00,0x00,
  0x0E,0x01,0x83,0x00,0x0C,0x07,0x01,0xC0,
  0x00,0x1C,0x00,0x60,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};

    char shi32L[]={
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x7F,0xFC,0x00,
  0x00,0xFF,0xFE,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x1F,0xFF,0xFF,0xFC,0x1F,0xFF,0xFF,0xFC,
  0x38,0x01,0x81,0xFC,0x00,0x01,0x80,0x18,
  0x00,0x21,0x84,0x00,0x00,0x61,0x8E,0x00,
  0x00,0xC1,0x87,0x00,0x01,0x81,0x83,0x80,
  0x03,0x01,0x81,0xC0,0x06,0x01,0x80,0x40,
  0x08,0x03,0x80,0x20,0x00,0x3F,0x80,0x00,
  0x00,0x1F,0x80,0x00,0x00,0x06,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};
    char yi16K[]={
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x7C,0x7F,0x86,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};
    char er16K[]={
  0x00,0x00,0x00,0x00,0x00,0x00,0x01,0xF0,
  0x0F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x0C,0x03,0xFE,0xFC,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};
    char san16K[]={
  0x00,0x00,0x00,0x00,0x00,0x00,0x01,0xE0,
  0x0E,0x00,0x00,0x00,0x00,0x00,0x01,0xC0,
  0x0E,0x00,0x00,0x00,0x00,0x00,0x01,0xFC,
  0x7E,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};


void drawmat(char *mat, int matsize, int x, int y, int color) /*汉字点阵*/
{
    int i, j, k, m;
    m = (matsize - 1) / 8 + 1;
    for(j = 0; j < matsize; j++)
        for(i = 0; i < m; i++)
            for(k = 0; k < 8; k++)
                if(mat[j*m+i]&(0x80 >> k))
                    putpixel(x + i * 8 + k, y + j, color);
}
/*******界面******/
void slight()
{
    int i;
    int driver=DETECT,mode=0;
    registerbgidriver(EGAVGA_driver);
    initgraph(&driver,mode,"");
    setbkcolor(7);
    setwritemode(0);
    setcolor(9);
    setlinestyle(0,1,1);
    rectangle(10,10,500,450);

    drawmat(zuo16K,16,530,380,3);
    drawmat(zhe16K,16,560,380,3);
    drawmat(zhan16K,16,520,410,5);
    drawmat(zhao16K,16,545,410,5);
    drawmat(ji16K,16,570,410,5);
    drawmat(han32L,32,560,60,4);
    drawmat(nuo32L,32,560,90,6);
    drawmat(ta32L,32,560,120,9);
    drawmat(yan32L,32,560,150,2);
    drawmat(shi32L,32,560,180,5);
    setcolor(4);
    line(100,100,100,300);
    line(250,100,250,300);
    line(400,100,400,300);
    setcolor(1);
    line(10,300,500,300);
    drawmat(yi16K,16,95,320,5);
    drawmat(er16K,16,245,320,2);
    drawmat(san16K,16,395,320,3);
}
void p(int hao,int pan,int ceng)/*pan（第几号盘，第几盘上，第几层）*/
{
    if(pan==1)
        line(100-hao*10,300-ceng*10,100+hao*10,300-ceng*10);
    if(pan==2)
        line(250-hao*10,300-ceng*10,250+hao*10,300-ceng*10);
    if(pan==3)
        line(400-hao*10,300-ceng*10,400+hao*10,300-ceng*10);
}
/********汉诺塔演示******/
void f(int n,int a,int b,int c)
{
    int ph;
    if(n==1)
    {
        sleep(1);
        if(a==1&&b==2)
        {
            setcolor(7);
            p(n,a,c1--);


            setcolor(6);
            c2++;
            ph=c2;
            p(n,b,ph);
        }

        if(a==1&&b==3)
        {
            setcolor(7);
            p(n,a,c1--);
            setcolor(6);
            c3++;
            ph=c3;
            p(n,b,ph);
        }
        if(a==2&&b==1)
        {
            setcolor(7);
            p(n,a,c2--);
            setcolor(6);
            c1++;
            ph=c1;
            p(n,b,ph);
        }
        if(a==2&&b==3)
        {
            setcolor(7);
            p(n,a,c2--);
            setcolor(6);
            c3++;
            ph=c3;
            p(n,b,ph);
        }
        if(a==3&&b==1)
        {
            setcolor(7);
            p(n,a,c3--);
            setcolor(6);
            c1++;
            ph=c1;
            p(n,b,ph);
        }
        if(a==3&&b==2)
        {
            setcolor(7);
            p(n,a,c3--);
            setcolor(6);
            c2++;
            ph=c2;
            p(n,b,ph);
        }
    }

    else
    {
        f(n-1,a,c,b);
        sleep(1);
        if(a==1&&b==2)
        {
            setcolor(7);
            p(n,a,c1--);
            setcolor(6);
            c2++;
            ph=c2;
            p(n,b,ph);
        }

        if(a==1&&b==3)
        {
            setcolor(7);
            p(n,a,c1--);
            setcolor(6);
            c3++;
            ph=c3;
            p(n,b,ph);
        }
        if(a==2&&b==1)
        {
            setcolor(7);
            p(n,a,c2--);
            setcolor(6);
            c1++;
            ph=c1;
            p(n,b,ph);
        }
        if(a==2&&b==3)
        {
            setcolor(7);
            p(n,a,c2--);
            setcolor(6);
            c3++;
            ph=c3;
            p(n,b,ph);
        }
        if(a==3&&b==1)
        {
            setcolor(7);
            p(n,a,c3--);
            setcolor(6);
            c1++;
            ph=c1;
            p(n,b,ph);
        }
        if(a==3&&b==2)
        {
            setcolor(7);
            p(n,a,c3--);
            setcolor(6);
            c2++;
            ph=c2;
            p(n,b,ph);
        }
        f(n-1,c,b,a);
    }


}
void main()
{
    int number;
    int a=1,b=2,c=3;
    int i,time;
    int *r;
    r=&c1;
    /********小窗口部分***********/
    printf("\n\n\n\n           Please input a number what you want and the time(SI=s):\n\n");
    printf("                                     ");
    scanf("%d",&number);
    scanf("%d",&time);
    printf("\n\n\n\n\n   Prompt:\n\n");
    printf("            This procedure dosen't working in any system but win XP.\n\n\n");
    printf("                      press any key to continue...");
    getch();
    *r=number;
    slight();
    sleep(5);
    for(i=1;i<=number;i++)
    {
        p(i,1,number-i+1);
    }
    f(number,a,b,c);
    getch();

}
